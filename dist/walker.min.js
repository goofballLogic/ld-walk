"use strict";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}module.exports={walk:function walk(a){function b(){return c.apply(this,arguments)}function c(){return c=_asyncToGenerator(regeneratorRuntime.mark(function a(b){var c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,j.expand(b);case 3:return c=a.sent,a.abrupt("return",k(c,{}));case 7:if(a.prev=7,a.t0=a["catch"](0),!(a.t0.details&&"loading document failed"==a.t0.details.code)){a.next=11;break}return a.abrupt("return",null);case 11:throw a.t0;case 12:case"end":return a.stop();}},a,null,[[0,7]])})),c.apply(this,arguments)}function d(){return e.apply(this,arguments)}function e(){return e=_asyncToGenerator(regeneratorRuntime.mark(function a(c){var e,g,h,i,j,l,m,n,o,p,q,r,s,t,u,v;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=c.pathContext,g=c.walkFrom,h=c.walkTo,i=c.lastFetched,j=c.query,l=c.suppressFinalDereferencing,a.next=3,f(e,h);case 3:if(m=a.sent,i){a.next=9;break}return a.next=7,b(g);case 7:j=a.sent,i=g;case 9:n=0;case 10:if(!(j&&j.query&&m.length)){a.next=26;break}if(o=m.shift(),n++,p="> ".concat(o),q=j.query(p),q){a.next=23;break}if(r=j.query("> @id"),!r){a.next=23;break}return i=r,a.next=21,b(r);case 21:s=a.sent,q=s&&s.query(p);case 23:j=q,a.next=10;break;case 26:if(!(!l&&j&&j.query)){a.next=35;break}if(t=j.query("> @id"),!(t&&t!==i)){a.next=35;break}return a.next=31,b(t);case 31:if(a.t0=a.sent,a.t0){a.next=34;break}a.t0=j;case 34:j=a.t0;case 35:return u=h.split(" "),v={walked:u.slice(0,n),toQuery:function toQuery(a){return j&&k(j.json(),a||{})},continueTo:function continueTo(a,b){return j?d(_objectSpread({},b,{pathContext:e,walkTo:a,lastFetched:i,query:j})):v},succeeded:!!j},v.succeeded||(v.notWalked=u.slice(n)),a.abrupt("return",v);case 39:case"end":return a.stop();}},a)})),e.apply(this,arguments)}function f(){return g.apply(this,arguments)}function g(){return g=_asyncToGenerator(regeneratorRuntime.mark(function a(b,c){var d,e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d={"@context":b,"@graph":c.split(" ").map(function(a){return _defineProperty({},a,[])})},a.next=3,j.expand(d);case 3:return e=a.sent,a.abrupt("return",e.map(function(a){return Object.keys(a)[0]}));case 5:case"end":return a.stop();}},a)})),g.apply(this,arguments)}function h(a,b){return{pathContext:a,walkFrom:b,to:function to(c,e){return d(_objectSpread({},e,{pathContext:a,walkFrom:b,walkTo:c}))}}}var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},j=i.jsonld||require("jsonld"),k=i.ldQuery||require("ld-query");return{pathContext:a,from:h.bind(this,a)}}};
